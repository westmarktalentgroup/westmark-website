name: ğŸ”„ Continuous Integration

on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  ci:
    name: ğŸ” Code Quality & Testing
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout Code
      uses: actions/checkout@v4
      
    - name: ğŸ“‹ Code Quality Check
      run: |
        echo "ğŸ” Running code quality checks..."
        
        # Check for common issues
        echo "Checking for TODO comments..."
        if grep -r "TODO\|FIXME\|HACK" --include="*.html" --include="*.css" --include="*.js" .; then
          echo "âš ï¸ Found TODO/FIXME comments"
        else
          echo "âœ… No TODO comments found"
        fi
        
        # Validate file structure
        echo "Validating file structure..."
        if [ -f "index.html" ] && [ -f "assets/css/optimized.css" ]; then
          echo "âœ… Core files present"
        else
          echo "âŒ Missing core files"
          exit 1
        fi
        
    - name: ğŸ¨ CSS Validation
      run: |
        echo "ğŸ¨ Validating CSS..."
        
        # Check for CSS issues
        if grep -q "!important" assets/css/optimized.css; then
          echo "âš ï¸ Found !important declarations"
        else
          echo "âœ… No !important declarations"
        fi
        
        # Check for responsive design
        if grep -q "@media" assets/css/optimized.css; then
          echo "âœ… Responsive design detected"
        else
          echo "âš ï¸ No responsive design found"
        fi
        
    - name: ğŸ“± Mobile Testing
      run: |
        echo "ğŸ“± Testing mobile compatibility..."
        
        # Check for mobile viewport
        if grep -q "viewport" index.html; then
          echo "âœ… Mobile viewport configured"
        else
          echo "âŒ Missing mobile viewport"
          exit 1
        fi
        
        # Check for horizontal scroll prevention
        if grep -q "overflow-x.*hidden" assets/css/optimized.css; then
          echo "âœ… Horizontal scroll prevention active"
        else
          echo "âš ï¸ No horizontal scroll prevention"
        fi
        
    - name: ğŸ”’ Security Validation
      run: |
        echo "ğŸ”’ Running security checks..."
        
        # Check for hardcoded credentials
        if grep -r "password\|secret\|key\|token" --include="*.html" --include="*.css" --include="*.js" . | grep -v "example\|placeholder"; then
          echo "âŒ Potential hardcoded credentials found"
          exit 1
        else
          echo "âœ… No hardcoded credentials"
        fi
        
        # Check for external resources
        echo "Checking external resources..."
        if grep -q "http://" --include="*.html" --include="*.css" --include="*.js" .; then
          echo "âš ï¸ Found HTTP resources (should use HTTPS)"
        else
          echo "âœ… All resources use HTTPS or relative paths"
        fi
        
    - name: âœ… CI Complete
      run: |
        echo "ğŸ‰ All CI checks passed!"
        echo "âœ… Code quality: PASSED"
        echo "âœ… CSS validation: PASSED" 
        echo "âœ… Mobile testing: PASSED"
        echo "âœ… Security check: PASSED"
